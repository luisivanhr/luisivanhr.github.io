:root{
  --scene-ar: 1.777777778;   /* 16/9 as a single number */
  --bars-color: #000000;
}

* { box-sizing: border-box; }
body { margin: 0; color: var(--ink); background: #5783ad; font-size: 22px; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial; }
a { color: #1a388b; text-decoration: none; }
a:hover { text-decoration: underline; }
.skip { position: absolute; left: -9999px; top: -9999px; }
.skip:focus { left: 16px; top: 16px; background:#000; padding:8px 12px; border-radius:6px; }


/* Letterbox container */
#desk-wrap{
  position: fixed; inset: 0;
  background: var(--bars-color);
  display:flex; align-items:center; justify-content:center;
  overflow:hidden;
}

/* Fill width; height derived from aspect-ratio */
.stage{
  position: relative;
  width: min(100vw, calc(100svh * var(--scene-ar)));
  aspect-ratio: var(--scene-ar);
}

/* fill the stage */
.desk-bg {
  position: absolute; inset:0; overflow:hidden;
  background: url('{{ "/assets/images/desk/background.png" | relative_url }}')
              center / cover no-repeat; /* or contain, depending on your export */
}
.desk-bg svg, .desk-bg canvas, .board-math{
  position:absolute; inset:0; width:100%; height:100%; display:block;
}

/* stacking (unchanged) */
#desk-bg-art{ z-index:1; }
#fx-layer{ z-index:8; pointer-events:none; }
#desk-hotspots{ z-index:5; }


/* Blackboard math overlay (keeps your current manual placement) */
:root{
  /* From your old px values: left=240, top=164, width=460 on a 1600×900 viewBox */
  --board-left: 17%;        /* 240 / 1600 * 100 */
  --board-top: 18.5%;     /* 164 / 900 * 100  */
  --board-width: 28.75%;    /* 460 / 1600 * 100 */
  --board-rotate: 0.5deg;
}

.board-math{
  position: absolute; 
  left: var(--board-left);
  top: var(--board-top);
  width: var(--board-width);
  aspect-ratio: 16 / 9;     /* keeps the board rectangular */
  height: auto;
  transform: perspective(8vw) rotateX(5deg) rotateY(4deg) rotateZ(3.5deg);
  will-change: transform;
  transform-origin: center;
  pointer-events: none;
  color: #fff;
            /* stays readable; scale with clamp(...) if you like */
  line-height: 1.4;
  z-index: 10;
}

/* Overlay “screen” area that we can paint into */
.screen.models {
  position: absolute;
  /* % values so it scales like the board */
  left: 29.9%;
  top: 49.5%;
  width: 23%;
  height: 19.8%;
  z-index: 10;
  overflow: hidden;

  /* shape it into a parallelogram (tweak these points) */
  /* order: top-left, top-right, bottom-right, bottom-left */
  clip-path: polygon(0.3% 0.6%, 84.5% 0.2%, 84.7% 84.5%, 0.2% 99.8%);
  -webkit-clip-path: polygon(0.3% 0.6%, 84.5% 0.2%, 84.7% 84.5%, 0.2% 99.8%); /* Safari */

  /* visual styling */
  border-radius: 3px;            /* optional */
  box-shadow: inset 0 0 18px rgba(51, 177, 223, 0.55);
  will-change: clip-path;
}
.screen.models {
  font-size: 6%; /* 6% of the box height */
}
/* your existing internals can stay the same */
.screen.models .slide { position:absolute; inset:0; opacity:0; transition:opacity .5s; display:grid; grid-template-rows:1fr auto; background:#123242; }
.screen.models .slide.show { opacity:1; }
.screen.models .slide .img { position:absolute; inset:0; background-size:cover; background-position:center; filter:brightness(1.05) contrast(1.05) saturate(1.05); }
.screen.models .slide .caption { position:relative; z-index:1; padding:6px 8px; background:linear-gradient(180deg, rgba(8,14,20,0) 0%, rgba(8,14,20,.85) 60%, rgba(8,14,20,.95) 100%); color:#e8f3ff; font-size:clamp(1px, 1vw, 16px); line-height:1.2; text-shadow:0 1px 2px rgba(0,0,0,.6); }

/* if you kept the scanline gloss, it must be clipped too */
.screen.models::after{
  content:""; position:absolute; inset:0;
  background:repeating-linear-gradient(to bottom, rgba(255,255,255,0.04), rgba(255,255,255,0.04) 1px, transparent 1px, transparent 3px);
  mix-blend-mode:screen; pointer-events:none; opacity:.25;
  clip-path: inherit; -webkit-clip-path: inherit;
}


/* Tooltip */
#tooltip { position: fixed; z-index: 50; background: #061019ee; border: 1px solid #153244; border-radius: 10px; padding: 10px 12px; width: 320px; box-shadow: 0 10px 30px #0008; }
#tooltip .thumb { width: 100%; height: 140px; object-fit: cover; border-radius: 8px; display:block; }
#tooltip .title { font-weight: 700; margin-top: 8px; }
#tooltip .meta { color: var(--muted); font-size: 0.9rem; }

/* ========== Top bar wrapper ========== */
.site-nav {
  position: sticky; top: 0; z-index: 9999;
  margin: 0;
  background: rgba(8,14,20,0.85);
  backdrop-filter: blur(6px);
  border-bottom: 1px solid rgba(255,255,255,0.08);

  /* Fluid base font size for the whole teaser bar */
  font-size: clamp(0.4rem, 1.0vw, 1.05rem);
}

/* ========== Teaser button ========== */
.nav-teaser {
  all: unset;
  display: flex; align-items: center;
  gap: 1em;                        /* was 2rem */
  width: 100%;
  padding: 0.4em 0.6em;            /* was 14px 18px */
  cursor: pointer;
  background: rgba(8,14,20,0.85);
  color: #eaf3ff;
  border-bottom: 1px solid #123242;
}

.nav-teaser:focus-visible { outline: 0.15em solid #64aaff; outline-offset: 0.2em; }

.nav-teaser .teaser-text { font-size: 1em; opacity: .9; }   /* scales with base */
.nav-teaser .chev { transition: transform .25s ease; }

/* Emphasized part */
.nav-teaser .teaser-text strong {
  font-size: 1.2em;          /* relative to bar size */
  color: #ffffff;
  margin-right: 0.3em;
}
.nav-teaser .teaser-text .hint {
  display: inline;
  font-size: 1em;            /* keep same scale; or 0.9em if you want it smaller */
  color: #1aa2e6;
}

/* Icon rotation */
[aria-expanded="true"] .icon { transform: rotate(90deg); }

/* Remove the old fixed font-size */
.nav-teaser { font-size: inherit; }

/* ========== Menu list when expanded ========== */
#nav-list[hidden] { display: none; }
#nav-list {
  padding: 0.6em 0.8em;
  animation: slideDown .25s ease;
}
@media (prefers-reduced-motion: reduce) {
  #nav-list { animation: none; }
  .nav-teaser .chev { transition: none; }
}

#nav-list ul {
  list-style: none; margin: 0; padding: 0;
  display: flex; flex-wrap: wrap; gap: 0.6em 0.8em;
}
#nav-list a {
  display: inline-block;
  padding: 0.35em 0.6em;
  border-radius: 0.45em;
  color: #cfe1ff; text-decoration: none;
}
#nav-list a:hover, #nav-list a:focus {
  background: rgba(255,255,255,0.08);
  outline: none;
}
#nav-list a.active {
  background: rgba(27,129,160,0.78);
  color: #ffffff;
}

[aria-expanded="true"] .chev { transform: rotate(180deg); }

@keyframes slideDown {
  from { opacity: 0; transform: translateY(-0.4em); }
  to   { opacity: 1; transform: translateY(0); }
}

/* ========== Home link styled like a button in teaser ========== */
.nav-teaser .home-link {
  padding: 0.3em 0.6em;
  border-radius: 0.4em;
  background: rgba(100,170,255,0.18);
  color: #fff;
  font-weight: 600;
  text-decoration: none;
  font-size: 1em; /* scales with base font */
}
.nav-teaser .home-link:hover,
.nav-teaser .home-link:focus {
  background: rgba(100,170,255,0.3);
  outline: none;
}

/* Keep desk visible under the nav */
#desk-wrap { margin-top: 0.5em; }